[참조한 영상 [코다의 Process vs Thread]](https://youtu.be/1grtWKqTn50)

### <용어>

실행단위 - cpu core에서 실행하는 하나의 단위로 프로세스와 스레드를 포괄하는 개념

프로세스 - 단 하나의 스레드만 가지고 있는 단일 스레드 프로세스

동시성 - 한 순간에 여러가지 일이 아니라, 짧은 전환으로 여러가지 일이 동시에 처리되는 것 처럼 보이는 것

---

# **프로그램과 프로세스**

CPU는 한순간에 한가지 일만 하고, 한순간에 여러가지 일은 일어나지 않는다. 

> **프로그램(운영체제) > 프로세스 > 스레드**
> 

**프로그램**은 코드파일, 실행시키기 전까지는 코드 일 뿐이다. (ex) 피자 레시피  

### **프로세스란 ?**

- 운영체제로 부터 자원을 할당 받는 작업의 단위
- 메모리에 올라와 실행되고 있는 프로그램의 인스턴스 ( 독립적인 개체 )
- 동적인 개념으로, 실행된 프로그램을 의미한다. 
예를 들어, 컴퓨터에서 카카오톡을 키고, 크롬을 키고, vscode를 키는데, 각각의 프로세스를 실행시키는 것이다.
- 기본적으로 프로세스당 최소 1개의 스레드(메인 스레드)를 가지고 있다.
- 한 프로세스가 다른 프로세스 자원에 접근을 하기 위해선 프로세스 간의 통신, IPC를 사용해야 함

![operation system](https://user-images.githubusercontent.com/95288297/200996317-e05379f4-5fd0-450d-bfa5-d3cd44ebd622.png, wight:500)


**[메모리]**

code : 실행 명령을 포함하는 코드들
data : Static 변수 혹은 Global 변수
heap : 동적 메모리 영역
stack : 지역변수, 매개변수, 변환 값등들 일시적인 데이터 

### **스레드란 ?**

- 프로세스가 할당받은 자원을 이용하는 실행의 단위이며, 프로세스 내에 여러 개 생길 수 있다. 
예시) 크롬에서 유튜브를 틀어놓고, 검색을 하는 작업들
- 프로세스 내에서 실행되는 여러 흐름의 단위
![process](https://user-images.githubusercontent.com/95288297/200996512-b233dff8-1251-4ecd-88c5-c0e1e3c6bd46.png)

---

# 프로세스 & 스레드

프로세스는 실행되고 있는 하나의 프로그램이고, 스레드는 프로세스 안에서 처리하고 있는 하나의 작업 단위 

프로세스는 독립된 자원을 할당 받아 사용하지만, 스레드는 프로세스 안에서 자원을 공유하며 실행한다.

 

### **Context-Switching(문맥교환)**

- cpu가 실행하는 프로세스를 교체할때 cpu에서 관리하는 context가 교체되는것을 말한다. 
이때 context란 cpu가 프로세스를 실행하기 위해 필요한 프로세스에 대한 정보로 프로세스의 context를 커널 내부에 존재하는 PCB에 저장한다.
- 인터럽트가 발생하면, 프로세스를 종료하고, 다음 프로세스를 수행하는데, 종료되기전 context를 pcb에 업데이트 하고, 실행할 다음 프로세스의 context를 준비상태로 변경해둬 cpu가 실행 할 수 있도록 해준다.
- 이러한 context-switching이 자주 일어나면 부하가 생기고, 성능이 떨어져 등장한 것이 경량화된 프로세스 버전인 **스레드** 이다.

### **스레드**

- 하나의 프로세스 안에 다수의 스레드가 있을 때 공유되는 자원이 있다.
- 프로세스 내에서 각각 Stack 만 따로 할당받고,Code, Data, Heap 영역은 공통된 자원을 사용해 효율적이고, Context-Switching을 할 때 캐싱 적중률이 올라간다.
- 각각의 스레드는 별도의 레지스터와 스택을 갖고 있지만, 힙 메모리는 서로 읽고 쓸 수 있다.

장점 → 자원 소모가 줄어든다. 응답 시간이 단축된다. 프로세스 간 통신이 간단한다. 

---

# 멀티프로세스 & 멀티스레드

⇒ 멀티프로세스와 멀티 스레드 두 가지 개념 모두 처리 방식의 일종 

### 멀티 프로세스 (Multi-process)

:  하나의 응용프로그램을 다수의 프로세스가 작업을 처리하는 것 

- 장점
    - 프로세스는 각각의 독립된 메모리를 할당받아 프로세스 사이에서 공유하는 메모리가 없기 때문에 하나의 프로세스가 잘 못 되더라도 그 프로세스에만 문제가 생겨 프로그램은 동작한다.
- 단점
    - IPC를 사용한 통신을 하는데, 각각의 독립된 메모리 영역을 할당받기 때문에 프로세스 사이의 변수를 공유할 수 없다.
    - Context Switching  비용이 크다.
    context switching 과정에서 캐쉬 메모리 초기화 등 무거운 작업이 진행되고 많은 시간이 소요되는 등의 오버헤드가 발생한다.
    - 자원이 소모적이고, 개별 메모리를 차지한다. (→ 동기화 작업이 필요X)

### 멀티 스레드 (Multi-thread)

:  하나의 응용프로그램을 여러 개의 스레드로 구성하고 각 스레드들이 하나의 작업을 처리하는 것

    웹 서버는 대표적인 멀티 스레드 응용 프로그램 

- 장점
    - 시스템 자원 효율성 증대 
    공유된 자원을 사용해 스레드간 데이터를 주고받는 것이 간단해져 통신 비용이 절감 되고, 메모리를 효율적으로 관리할 수 있다.
    - 스레드 사이의 작업량 감소로 Context Switching 비용이 적음
    - 간단한 통신 방법을 사용하기때문에 프로그램 응답 시간은 단축된다. 
    프로세스간 통신보다 스레드 간 통신의 비용이 적어 작업들의 통신 부담이줄어든다.
- 단점
    - 디버깅이 까다롭다
    - 멀티 스레드의 경우 동기화 문제가 발생한다. 
    스레드간의 자원 공유는 전역변수(데이터 세그먼트) 를  이용하므로 함께 상용할때 충돌이 발생 할 수 있다. 
    (세그먼트는 메모리 보호를 수행하는 가장 일반적인 방법 가운데 하나로, 그중 데이터 세그먼트에서 호출된 변수들은 프로그램 시작과 함께 선언되며 프로그램 종료시 소멸된다.)
    - 스레드 사이가 긴밀히 연결되어 있기 때문에 설계가 복잡하고, 하나의 스레드에 문제 발생시 전체 프로세스가 영향을 받는다.

### 멀티코어

: 하드웨어 관점에서 물리적 구성 단위 ( 동시성, 병렬처리 )
<img width="500" alt="스크린샷 2022-11-10 오후 12 44 13" src="https://user-images.githubusercontent.com/95288297/200996391-fdd8d352-30d5-4e1e-a622-18ae663d2977.png">



**Concurrency (동시성)** 

: 하나의 코어에서 하나 이상의 프로세스(혹은 스레드)가 번갈아가면서 진행되지만 동시에 진행되는 것 처럼 보이는 것 / 짧은 순간의 cpu의 시간을 분할해 동시에 일어나는 것 처럼 보이도록 함

**Parallelism (병렬처리)**

: 물리적으로 여러 코어를 사용해서 하나 이상의 프로세스 (혹은 스레드)가 한꺼번에 진행되는 것 

### 참고한 문서

[[OS] 프로세스와 스레드의 차이 - Heee's Development Blog](https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html)
